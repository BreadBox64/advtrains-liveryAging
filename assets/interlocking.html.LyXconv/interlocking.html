<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title></title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<!-- html --> 
<meta name="src" content="interlocking.tex"> 
<link rel="stylesheet" type="text/css" href="interlocking.css"> 
</head><body 
>
<!--l. 18--><p class="noindent" >


<!--l. 18--><p class="noindent" ><span 
class="ecsx-1728">Interlocking</span>
<span 
class="ecsx-1728">System</span>
<span 
class="ecsx-1728">Guide</span>
<div class="tabular"> <table id="TBL-1" class="tabular" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-1-1g"><col 
id="TBL-1-1"></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-1-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-1-1"  
class="td00"></td></tr></table>
</div>
<a 
 id="x1-2r1"></a>
    <!--l. 20--><p class="noindent" ><span 
class="ecsx-1200">1</span>   <span 
class="ecsx-1200">Introduction</span>
<a 
 id="Q1-1-0"></a>
<!--l. 22--><p class="noindent" >In real-world railways, a so-called interlocking system is a set of railway signals and trackside equipment. Its purpose is to prevent
conflicting train movements which otherwise could result in derailing or colliding trains. If you want more information, just search for
&#8220;railway interlocking&#8221; on the internet.
<!--l. 28--><p class="noindent" >Real-world interlocking systems perform this task by setting routes. A route is a path along a track that a train can safely pass. To set a
route for a train, the signalman (the operator of a signal box) has to set switches (turnouts) to the correct position and lock them in order
to make a signal for a train show &#8220;Proceed&#8221;. In newer systems, this is done automatically by the interlocking system. A route can
not be set if switches are locked to a wrong position by another route or if any portion of the route is occupied by a
train.
<!--l. 37--><p class="noindent" >The interlocking system in this Minetest mod tries to follow real-world interlocking systems as far as applicable. It divides tracks into
track sections and implements a route setting mechanism following the same principle.
<!--l. 42--><p class="noindent" >However, for the sake of simplicity of implementation and usage, not all concepts of real-world interlocking have been taken over.
Especially, there is no mechanism for overlap.
<!--l. 46--><p class="noindent" >If you are looking for a place to learn how real-world interlocking systems work, have a look at &#8220;SimSig&#8221;. By looking at their simulations,
you can obtain experience on how to set up your own interlocking systems in AdvTrains. The SimSig glossary is a good place to look up
unknown terms in this document.
<!--l. 52--><p class="noindent" >
<a 
 id="x1-3r2"></a>
    <!--l. 52--><p class="noindent" ><span 
class="ecsx-1200">2</span>   <span 
class="ecsx-1200">Setting</span>
    <span 
class="ecsx-1200">up</span>
    <span 
class="ecsx-1200">track</span>
    <span 
class="ecsx-1200">sections</span>
<a 
 id="Q1-1-0"></a>
<!--l. 54--><p class="noindent" >In the real world, a line of track is divided into so-called track sections, or track circuits. Those systems often can not tell
where exactly a train is, but only which track sections it occupies. A route can never be set through an occupied track
section.
<!--l. 59--><p class="noindent" >A track section often covers:
     <ul class="itemize1">
     <li class="itemize">A section on a main running line, between two signals
     </li>
     <li class="itemize">A single turnout
     </li>
     <li class="itemize">A rail crossing, or a set of turnouts acting as a double/single slip switch
     </li>
     <li class="itemize">A siding</li></ul>
<!--l. 67--><p class="noindent" >You will find some examples on how to interlock certain patterns later.
<!--l. 69--><p class="noindent" >
<a 
 id="x1-4r1"></a>
      <!--l. 69--><p class="noindent" ><span 
class="ecsx-1200">2.1</span>   <span 
class="ecsx-1200">Track</span>
      <span 
class="ecsx-1200">Circuit</span>
      <span 
class="ecsx-1200">Breaks</span>
<a 
 id="Q1-1-0"></a>
<!--l. 71--><p class="noindent" >In this mod, you will not directly configure the locations of track sections. Instead, you designate the borders of each track section using a
special node, the Track Circuit Break, abbreviated TCB.
<!--l. 75--><p class="noindent" >For example, if you want to create a track section for a piece of a main running line, you set up two TCBs at the ends of this track
circuit.
<!--l. 79--><p class="noindent" >Setting up a TCB works as follows:
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-6x1">Place a TCB node somewhere near the place where the circuit break is going to be located.
     </li>
     <li 
  class="enumerate" id="x1-8x2">Right-click the TCB node
     </li>
     <li 
  class="enumerate" id="x1-10x3">Punch the rail which should act as TCB</li></ol>
<!--l. 86--><p class="noindent" >The result should look like this:
<!--l. 88--><p class="noindent" ><img 
src="0_home_moritz_Home_Projekte_Minetest_minetest_m___s_assets_lyx_img_screenshot_20180830_142551.png" alt="PIC"  
>
<!--l. 90--><p class="noindent" >Now you have assigned the TCB node to a rail. Right-click the TCB node once again. This will bring up a form which looks as
follows:
<!--l. 93--><p class="noindent" ><img 
src="1_home_moritz_Home_Projekte_Minetest_minetest_m____lyx_img_Bildschirmfoto_2018-08-30_14-26-35.png" alt="PIC"  
>
<!--l. 95--><p class="noindent" >You see that the form is divided in side A and side B. To designate where each side is, a marker is displayed on the rail. You can always
make this marker show up by punching the TCB node, and remove it by punching the marker. Both sides are shown as &#8220;End of
interlocking&#8221;. This means that there is no track section set up at this place.
<!--l. 101--><p class="noindent" >You should repeat this procedure once again a few meters away from the first TCB to create a second TCB on the same
track.
<!--l. 104--><p class="noindent" ><img 
src="2_home_moritz_Home_Projekte_Minetest_minetest_m____lyx_img_Bildschirmfoto_2018-08-30_14-32-48.png" alt="PIC"  
>
<!--l. 106--><p class="noindent" >Once you have both bordering TCBs set up, you can now create the actual track section. To do this:
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-12x1">Right-click one of the TCBs
     </li>
     <li 
  class="enumerate" id="x1-14x2">Locate the correct side (A or B) to create the track section
     </li>
     <li 
  class="enumerate" id="x1-16x3">Click &#8220;Create interlocked Track Section&#8221; in the formspec on the chosen side.</li></ol>
<!--l. 114--><p class="noindent" >Now, the text on the formspec has changed. It shows something like this:
<!--l. 117--><p class="noindent" ><img 
src="3_home_moritz_Home_Projekte_Minetest_minetest_m____lyx_img_Bildschirmfoto_2018-08-30_14-27-25.png" alt="PIC"  
>
<!--l. 119--><p class="noindent" >Clicking &#8220;Show Track Section&#8221; brings up another formspec:
<!--l. 121--><p class="noindent" ><img 
src="4_home_moritz_Home_Projekte_Minetest_minetest_m____lyx_img_Bildschirmfoto_2018-08-30_14-28-32.png" alt="PIC"  
>
<!--l. 123--><p class="noindent" >On the top, you see a list of all TCBs that border this track section. In your case, there should be two TCBs listed. If there&#8217;s only one,
head over to <a 
href="#x1-17r2">2.2<!--tex4ht:ref: subsec:Long-track-sections, --></a>. You should now select a name for the track section, to identify it later.
<!--l. 128--><p class="noindent" >The same procedure is applicable when you create a turnout track section, except that you have to set up three or more
TCBs.
<!--l. 131--><p class="noindent" >The AdvTrains interlocking system allows you to add more TCBs after you have created a track section. This works without problems in
most cases. For example, you can easily insert a turnout into an already set-up track section and create another TCB behind it, and
AdvTrains will automatically detect the existing track section. Problems arise only if you try to insert a TCB in-between a section, in
which case both sides of the TCB will end up assigned to the same section. The code currently does not handle this case properly, so try
to avoid this situation by all means. As a last resort, you can always dissolve a faulty track section, as described in the next
chapter.
<!--l. 142--><p class="noindent" >
<a 
 id="x1-17r2"></a>
      <!--l. 142--><p class="noindent" ><span 
class="ecsx-1200">2.2</span>   <span 
class="ecsx-1200">Long</span>
      <span 
class="ecsx-1200">track</span>
      <span 
class="ecsx-1200">sections,</span>
      <span 
class="ecsx-1200">crossings</span>
      <span 
class="ecsx-1200">and</span>
      <span 
class="ecsx-1200">other</span>
      <span 
class="ecsx-1200">edge</span>
      <span 
class="ecsx-1200">cases</span>
<a 
 id="Q1-1-0"></a>
<!--l. 144--><p class="noindent" >
<a 
 id="x1-18r1"></a>
      <!--l. 144--><p class="noindent" ><span 
class="ecsx-1000">2.2.1</span>   <span 
class="ecsx-1000">Very</span>
      <span 
class="ecsx-1000">long</span>
      <span 
class="ecsx-1000">track</span>
      <span 
class="ecsx-1000">sections</span>
<a 
 id="Q1-1-0"></a>
<!--l. 146--><p class="noindent" >If you try to set up a track section that is longer than 1000 nodes, advtrains won&#8217;t recognize the TCB at the other end because of a safety
limit in the traverser function, which is supposed to prevent deadlocks. This case has happened when the Track Section overview screen
only shows one TCB in the list. The procedure for this is as follows:
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-20x1">Go to the second TCB (the one that wasn&#8217;t recognized). It should show &#8220;End of Interlocking&#8221; on the relevant side.
     </li>
     <li 
  class="enumerate" id="x1-22x2">Click &#8220;Create interlocked track section&#8221;. The section created will be different from the one that is already present.
     </li>
     <li 
  class="enumerate" id="x1-24x3">In the track section overview, click &#8220;Join into other section&#8221;
     </li>
     <li 
  class="enumerate" id="x1-26x4">Go back to the first TCB, bring up the Track Section overview screen of the first track section and click &#8220;Join with ???&#8221;</li></ol>
<!--l. 160--><p class="noindent" >The other, missing TCB should now appear in the list. If you accidentally started such a joining procedure, click the &#8220;X&#8221; button on the
right.
<!--l. 164--><p class="noindent" >
<a 
 id="x1-27r2"></a>
      <!--l. 164--><p class="noindent" ><span 
class="ecsx-1000">2.2.2</span>   <span 
class="ecsx-1000">Rail</span>
      <span 
class="ecsx-1000">crosses</span>
<a 
 id="Q1-1-0"></a>
<!--l. 166--><p class="noindent" >Since rail crosses are created by laying tracks across each other without logical connection, there&#8217;s no way for advtrains to know whether
rails cross each other.
<!--l. 170--><p class="noindent" >Rail crossings in interlocking systems are always one single track section, which in most cases has 4 TCBs adjacent.
<!--l. 173--><p class="noindent" ><img 
src="5_home_moritz_Home_Projekte_Minetest_minetest_m____lyx_img_Bildschirmfoto_2018-08-30_14-51-25.png" alt="PIC"  
>
<!--l. 175--><p class="noindent" >The procedure is quite similar to the one for long sections: First, create two track sections for the branches, and then use the &#8220;Join&#8221;
function to merge both sections into one.
<!--l. 179--><p class="noindent" >
<a 
 id="x1-28r3"></a>
      <!--l. 179--><p class="noindent" ><span 
class="ecsx-1000">2.2.3</span>   <span 
class="ecsx-1000">Deleting</span>
      <span 
class="ecsx-1000">and</span>
      <span 
class="ecsx-1000">re-adding</span>
      <span 
class="ecsx-1000">single</span>
      <span 
class="ecsx-1000">TCBs</span>
      <span 
class="ecsx-1000">to</span>
      <span 
class="ecsx-1000">a</span>
      <span 
class="ecsx-1000">section</span>
<a 
 id="Q1-1-0"></a>
<!--l. 181--><p class="noindent" >In some occasions, for example when you remove a siding or a crossover, it can be necessary to unassign a TCB from a track section.
There are multiple ways to do this:
     <ul class="itemize1">
     <li class="itemize">In the TCB form, click the &#8220;Remove from section&#8221; button
     </li>
     <li class="itemize">In the track section form, first select the TCB in the list and then click &#8220;Unlink selected TCB&#8221;</li></ul>
<!--l. 189--><p class="noindent" >The result is that the TCB shows &#8220;End of Interlocking&#8221; and the section does not list the TCB as an endpoint anymore.
<!--l. 192--><p class="noindent" >The other case is adding a siding or a crossover, in which case one or more TCBs still show &#8220;End of Interlocking&#8221; although they should be
part of a section:
     <ul class="itemize1">
     <li class="itemize">Go to another TCB that is registered in the track section and click &#8220;Update near TCBs&#8221;
     </li>
     <li class="itemize">If that did not work, follow the procedure of creating a long track section</li></ul>
<!--l. 202--><p class="noindent" >
<a 
 id="x1-29r4"></a>
      <!--l. 202--><p class="noindent" ><span 
class="ecsx-1000">2.2.4</span>   <span 
class="ecsx-1000">Dissolving</span>
      <span 
class="ecsx-1000">sections</span>
<a 
 id="Q1-1-0"></a>
<!--l. 204--><p class="noindent" >If you made a mistake setting up something and you don&#8217;t see any other way to fix a misconfigured track section, you can always
delete it using the &#8220;Dissolve section&#8221; button. This operation removes the track section and sets all TCBs that previously
belonged to the section as &#8220;End of Interlocking&#8221;. This will always work and lets you start over new with setting up track
sections.
<!--l. 211--><p class="noindent" >
<a 
 id="x1-30r3"></a>
      <!--l. 211--><p class="noindent" ><span 
class="ecsx-1200">2.3</span>   <span 
class="ecsx-1200">Interlocking</span>
      <span 
class="ecsx-1200">patterns</span>
<a 
 id="Q1-1-0"></a>
<!--l. 213--><p class="noindent" >This section shows some examples on how you should set up track sections on certain track configurations.
<!--l. 216--><p class="noindent" >
<a 
 id="x1-31r3"></a>
    <!--l. 216--><p class="noindent" ><span 
class="ecsx-1200">3</span>   <span 
class="ecsx-1200">Signals</span>
    <span 
class="ecsx-1200">and</span>
    <span 
class="ecsx-1200">routes</span>
<a 
 id="Q1-1-0"></a>
<!--l. 218--><p class="noindent" >The purpose of signals is to inform trains about whether they can proceed into the next section safely. Making a section of track safe to
pass for a train, turnouts need to be set to the correct position and no other train should be allowed to cross or share parts of the route
with this train.
<!--l. 224--><p class="noindent" >
<a 
 id="x1-32r1"></a>
      <!--l. 224--><p class="noindent" ><span 
class="ecsx-1200">3.1</span>   <span 
class="ecsx-1200">Assigning</span>
      <span 
class="ecsx-1200">Signals</span>
      <span 
class="ecsx-1200">to</span>
      <span 
class="ecsx-1200">TCBs</span>
<a 
 id="Q1-1-0"></a>
<!--l. 226--><p class="noindent" >Signals in the advtrains interlocking system are positioned - like in real life - at the border of track sections.
<!--l. 229--><p class="noindent" >When you set up a signal, do the following steps:
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-34x1">If not already happened, set up a TCB (you don&#8217;t need to, but are advised to, configure track sections there)
     </li>
     <li 
  class="enumerate" id="x1-36x2">Place the signal a few meters in front of the TCB, so that trains stopping at the signal do never pass the TCB
     </li>
     <li 
  class="enumerate" id="x1-38x3">Locate the side of the TCB which points in the direction that trains will proceed past the signal, as shown in the figure
     below.
     </li>
     <li 
  class="enumerate" id="x1-40x4">Right-click the TCB, and click &#8220;Assign a signal&#8221; on this side.
     </li>
     <li 
  class="enumerate" id="x1-42x5">Punch the signal.</li></ol>
<!--l. 240--><p class="noindent" ><img 
src="6_home_moritz_Home_Projekte_Minetest_minetest_mods_advtrains_assets_lyx_img_assign_signal.png" alt="PIC"  
>
<!--l. 242--><p class="noindent" >You can assign a signal to each side of a TCB. This is, for example, useful when creating block sections on a bi-directional main running
line.
<!--l. 246--><p class="noindent" >
<a 
 id="x1-43r2"></a>
      <!--l. 246--><p class="noindent" ><span 
class="ecsx-1200">3.2</span>   <span 
class="ecsx-1200">The</span>
      <span 
class="ecsx-1200">concept</span>
      <span 
class="ecsx-1200">of</span>
      <span 
class="ecsx-1200">routes</span>
<a 
 id="Q1-1-0"></a>
<!--l. 248--><p class="noindent" >A so-called route is a locked path between two signals, which locks all turnouts in the correct position.
<!--l. 251--><p class="noindent" >Example: Imagine a station with 2 platforms on a single track running line. We are looking at signal A. You probably want trains coming
from the right to go into platform 1 or into platform 2, so you need to program 2 routes.
<!--l. 256--><p class="noindent" ><img 
src="7_home_moritz_Home_Projekte_Minetest_minetest_mods_advtrains_assets_lyx_img_route_ex1.png" alt="PIC"  
>
<!--l. 258--><p class="noindent" >This leads us to the most important aspect of route programming: Routes always start at a signal (A) and end at a signal facing in the
<span 
class="ecbx-1000">same direction </span>(D and E), not at an opposite-facing signal (B and C). There are only few exceptions, we&#8217;ll cover this
later.
<!--l. 263--><p class="noindent" >When you set a route to make a train proceed on it, the interlocking system ensures that:
     <ul class="itemize1">
     <li class="itemize">There are no rail vehicles on the route
     </li>
     <li class="itemize">All turnouts are set to the correct position and it is impossible to move them
     </li>
     <li class="itemize">No other routes can be set that would in any way conflict with this route</li></ul>
<!--l. 272--><p class="noindent" >For this to work, you need to specify all track sections the train will pass along, as well as the positions of all turnouts that need to be
locked. Those are not only the turnouts that lay directly on the train&#8217;s route, but also some turnouts on adjacent tracks, the so-called
flank protection.
<!--l. 278--><p class="noindent" >The purpose of flank protection is to prevent runaway trains and/or wagons to pass into a route. This is achieved by setting nearby
turnouts to a position that points &#8220;away&#8221; from the route. Example:
<!--l. 282--><p class="noindent" ><img 
src="8_home_moritz_Home_Projekte_Minetest_minetest_mods_advtrains_assets_lyx_img_route_ex2.png" alt="PIC"  
>
<!--l. 284--><p class="noindent" >The upper turnout, of course, needs to be locked in straight (normal) position, while the lower one is not relevant for the route itself. But
what if the lower turnout was set to the diverging (reverse) position and the driver of another train approaching signal B fails to see the
red light? This train would crash into the first one. To minimise danger, that other train would need to be routed towards signal
D.
<!--l. 291--><p class="noindent" >There are, of course, situations, where both positions of a turnout would conflict with a route equally. In those situations, there&#8217;s nothing
you can do and no flank lock needs to be set.
<!--l. 295--><p class="noindent" >
<a 
 id="x1-44r3"></a>
      <!--l. 295--><p class="noindent" ><span 
class="ecsx-1200">3.3</span>   <span 
class="ecsx-1200">Shunt</span>
      <span 
class="ecsx-1200">routes</span>
<a 
 id="Q1-1-0"></a>
<!--l. 297--><p class="noindent" >Operating railways is not all about driving trains around. Coupling, decoupling and moving single engines, wagons or groups of wagons
across a station, called shunting, also plays an important role.
<!--l. 301--><p class="noindent" >Remember what we said about routes: There must be no rail vehicles on the route. So what if you have some goods wagons
ready on a siding, and want to couple an engine to it? You can not set a regular route into the siding, because it is
occupied.
<!--l. 306--><p class="noindent" >The solution is to program a second route into the siding, but with the difference that it already ends at the rear-facing signal of it, so it
doesn&#8217;t include the siding section itself:
<!--l. 310--><p class="noindent" ><img 
src="9_home_moritz_Home_Projekte_Minetest_minetest_mods_advtrains_assets_lyx_img_route_ex3.png" alt="PIC"  
>
<!--l. 312--><p class="noindent" >The Sht2 route then needs to show a shunt aspect, which instructs the driver to proceed slowly and watch out for vehicles on the route.
To show a &#8220;free&#8221; aspect here would be wrong, because that would mean that the track is free until the next main signal, which it is clearly
not.
<!--l. 320--><p class="noindent" ><span 
class="ecti-1000">Note that advtrains_interlocking currently does not allow to set individual aspects for routes, this is a feature still to be implemented</span>
<span 
class="ecti-1000">soon.</span>
<!--l. 322--><p class="noindent" >Shunt routes like this are, so far, the only exception to the &#8220;Routes should end at a signal facing the same direction&#8221;
rule.
<!--l. 325--><p class="noindent" >
<a 
 id="x1-45r4"></a>
      <!--l. 325--><p class="noindent" ><span 
class="ecsx-1200">3.4</span>   <span 
class="ecsx-1200">Route</span>
      <span 
class="ecsx-1200">Release</span>
<a 
 id="Q1-1-0"></a>
<!--l. 327--><p class="noindent" >In early real-life interlocking systems, routes either had to be cancelled by the signalman after the train had passed the route, or there was
a single release contact at the end of the route. However, as interlocking systems evolved and the position of trains is now
roughly known by the track sections, portions of the route can be freed as soon as the train has left the corresponding
section.
<!--l. 334--><p class="noindent" >AdvTrains has chosen a modern approach to route releasing. Each turnout lock is associated to a track section belonging to the route&#8217;s
path. Once the train leaves this section, all assigned locks are also freed.
<!--l. 338--><p class="noindent" >
<a 
 id="x1-46r5"></a>
      <!--l. 338--><p class="noindent" ><span 
class="ecsx-1200">3.5</span>   <span 
class="ecsx-1200">Programming</span>
      <span 
class="ecsx-1200">a</span>
      <span 
class="ecsx-1200">route</span>
<a 
 id="Q1-1-0"></a>
<!--l. 340--><p class="noindent" >The route programming procedure is quite straightforward if you&#8217;ve read the previous sections and understood how routes should be
set.
<!--l. 343--><p class="noindent" >Routes always start at a signal. You must have assigned the signal to a TCB, as described earlier.
<!--l. 346--><p class="noindent" >When you right-click the signal, it no longer changes its aspect. Instead, a formspec pops up, showing you an (empty) list of routes with
the possibility to set them or to create new routes. Click the &#8220;Create new route&#8221; button to start programming a new
route.
<!--l. 351--><p class="noindent" >The form closes, and an arrow is displayed on the TCB. You are now in &#8220;Route Programming&#8221; mode, programming the first track section
of the route. Now:
     <ul class="itemize1">
     <li class="itemize">Put any turnouts you need to lock in the correct position (e.g. by right-clicking them). This includes flank protection.
     </li>
     <li class="itemize">Punch them. This makes a marker saying &#8220;Route Lock Editing&#8221; appear.
     </li>
     <li class="itemize">If you punch a turnout again, or punch the marker, you can remove the lock again.
     </li>
     <li class="itemize">When you&#8217;ve locked all turnouts in the current section, go to and punch the TCB that is the border to the next track
     section the train proceeds into.</li></ul>
<!--l. 364--><p class="noindent" >Once you&#8217;ve done this, the lock markers change to &#8220;Route Lock&#8221;, telling they can&#8217;t be changed anymore. Repeat the above procedure until
you have punched the final TCB, at which the route should end. As mentioned before, there should be a signal at this place,
however this is not enforced. Now, run the chat command <span 
class="ectt-1000">/at_rp_set &#x003C;name of route&#x003E; </span>to complete programming the
route.
<!--l. 371--><p class="noindent" >A few hints:
     <ul class="itemize1">
     <li class="itemize">If one turnout should be locked by more than one section, set the lock only in the <span 
class="ectt-1000">last </span>of those sections. Locking the same
     turnout in multiple sections of a single route results in undefined behavior!
     </li>
     <li class="itemize">If you accidentally punched a TCB, you can run <span 
class="ectt-1000">/at_rp_back </span>to undo this and return to the previous section. Due to a
     bug, you have to re-set all locks of this section.
     </li>
     <li class="itemize">If you want to stop programming the entire route without saving it, run <span 
class="ectt-1000">/at_rp_discard</span></li></ul>
<!--l. 384--><p class="noindent" >
<a 
 id="x1-47r4"></a>
    <!--l. 384--><p class="noindent" ><span 
class="ecsx-1200">4</span>   <span 
class="ecsx-1200">Interlocking</span>
    <span 
class="ecsx-1200">system</span>
    <span 
class="ecsx-1200">operation</span>
<a 
 id="Q1-1-0"></a>
<!--l. 386--><p class="noindent" >Setting up the interlocking for a portion of a railway network requires some time, experience and planning, but once done, there&#8217;s not
much to do anymore to make trains run on your, now safer, railway. This section covers some useful practices to route trains across your
network.
<!--l. 391--><p class="noindent" >At the moment, routes can only be set by clicking the signal or via LuaATC, except if you use automatic working. It is planned to control
this via the onboard computer and via a &#8220;signal box&#8221; view based on the currently broken itrainmap.
<!--l. 396--><p class="noindent" >
<a 
 id="x1-48r1"></a>
      <!--l. 396--><p class="noindent" ><span 
class="ecsx-1200">4.1</span>   <span 
class="ecsx-1200">Simple</span>
      <span 
class="ecsx-1200">route</span>
      <span 
class="ecsx-1200">setting</span>
      <span 
class="ecsx-1200">and</span>
      <span 
class="ecsx-1200">cancelling</span>
<a 
 id="Q1-1-0"></a>
<!--l. 398--><p class="noindent" >To set a route, simply right-click the signal, select a route and click &#8220;set route&#8221;. If there are no conflicts, the signal turns green and the
train is allowed to proceed.
<!--l. 402--><p class="noindent" >It may be possible that the route can not be set, because one or more other routes conflict with the current one, or a section is blocked. In
this case, the signal stays red, and the conflicting item is shown in the formspec. As soon as the conflict is resolved (by cancellation
or release of the conflicting route, or the section becoming free), the requested route will be set and the signal turns
green.
<!--l. 409--><p class="noindent" >If a route is either requested or set, it can be cancelled from the signalling formspec. This means that all turnouts and sections are
released, and the signal reverts back to red. This of course only works when the train has not passed the signal yet. There is no
mechanism for Approach Locking.
<!--l. 415--><p class="noindent" >
<a 
 id="x1-49r2"></a>
      <!--l. 415--><p class="noindent" ><span 
class="ecsx-1200">4.2</span>   <span 
class="ecsx-1200">Automatic</span>
      <span 
class="ecsx-1200">Working</span>
<a 
 id="Q1-1-0"></a>
<!--l. 417--><p class="noindent" >Block signals on main running lines usually only have a single route to set, the one proceeding along the main line. Their purpose is only
to show whether there are trains in the next section. So, it would be convenient if this only route would set itself again after a train
passed.
<!--l. 423--><p class="noindent" >This is what Automatic Working is for. Set a route, click &#8220;Enable Automatic Working&#8221;, and as soon as a train passes, the route is
automatically re-set.
<!--l. 427--><p class="noindent" >This function is nearly identical to SimSig automatic signals. It can also be useful on a line with high traffic, when there&#8217;s a
low-frequented access to a siding. You&#8217;d enable automatic working for the main route and cancel it only when you need a train to go into
the siding.
<!--l. 432--><p class="noindent" >
<a 
 id="x1-50r5"></a>
    <!--l. 432--><p class="noindent" ><span 
class="ecsx-1200">5</span>   <span 
class="ecsx-1200">Final</span>
    <span 
class="ecsx-1200">notes</span>
<a 
 id="Q1-1-0"></a>
<!--l. 434--><p class="noindent" >The interlocking system is mainly finished, though there are still some plans and ideas. They include:
     <ul class="itemize1">
     <li class="itemize">Setting routes from inside a train (via onboard computer)
     </li>
     <li class="itemize">Signalbox panels, as revival of itrainmap
     </li>
     <li class="itemize">Individual signal aspects for routes
     </li>
     <li class="itemize">Distant signals
     </li>
     <li class="itemize">On-Train head-up display for oncoming signals (they have something like this in Czech Republic, I forgot how it&#8217;s called.)</li></ul>
<!--l. 444--><p class="noindent" >Apart from this, there&#8217;s the large oncoming project of a new timetable-based train automation system, but this will take some time to
evolve and is out of the scope of this document.
<!--l. 448--><p class="noindent" >If you have any suggestions, corrections, improvements, criticism or cute kittens and stuff, you can always contact me by various means
(Forum PM, E-Mail (orwell@bleipb.de), Linuxworks server chat a.s.o.). Have fun!
<!--l. 453--><p class="noindent" >- orwell  
</body></html> 



